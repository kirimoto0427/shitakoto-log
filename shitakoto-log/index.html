<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>„Åó„Åü„Åì„Å®„É≠„Ç∞</title>
  <style>
    :root{
      --bg:#f7f9ff;
      --card:#ffffffcc;
      --ink:#1b1f2a;
      --sub:#5f6b7a;
      --accent:#4b7cff;
      --accent2:#e9f0ff;
      --danger:#e05555;
      --line:#e7ecf6;
      --shadow: 0 10px 30px rgba(20,30,60,.08);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", sans-serif;
      background: linear-gradient(180deg, #f7f9ff 0%, #f2f6ff 60%, #f7f9ff 100%);
      color:var(--ink);
    }
    .wrap{
      max-width: 760px;
      margin: 0 auto;
      padding: 20px 14px 40px;
    }
    header{
      display:flex;
      align-items:flex-end;
      gap:12px;
      margin: 8px 6px 10px;
    }
    .title{
      font-size: 26px;
      font-weight: 800;
      letter-spacing: .02em;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .dot{
      width:14px;height:14px;border-radius:99px;
      background: radial-gradient(circle at 30% 30%, #ffd26a, #ffb200);
      box-shadow: 0 6px 14px rgba(255,178,0,.25);
      display:inline-block;
    }
    .today{
      font-size: 14px;
      color: var(--sub);
      margin-bottom: 3px;
    }

    .tabs{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      padding: 10px 6px 0;
      margin-bottom: 10px;
    }
    .tab{
      border:0;
      padding: 10px 14px;
      border-radius: 999px;
      background: #eef3ff;
      color: #3752a6;
      font-weight: 700;
      cursor:pointer;
      transition: .15s;
    }
    .tab.active{
      background: var(--accent);
      color: white;
      box-shadow: 0 10px 22px rgba(75,124,255,.22);
    }

    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      margin: 10px 6px;
      backdrop-filter: blur(6px);
    }

    .sectionTitle{
      font-weight: 800;
      margin: 0 0 10px;
      font-size: 14px;
      color: var(--sub);
    }

    .presetGrid{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-bottom: 12px;
    }
    .presetBtn{
      width:100%;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: white;
      font-weight: 800;
      cursor:pointer;
      transition:.12s;
    }
    .presetBtn:hover{ transform: translateY(-1px); }

    .addRow{
      display:flex;
      gap:10px;
      align-items:center;
      margin-top: 10px;
      flex-wrap:wrap;
    }
    input[type="text"]{
      flex:1;
      min-width: 240px;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid var(--line);
      outline:none;
      font-size: 16px;
      background: white;
    }
    .addBtn{
      padding: 12px 18px;
      border-radius: 14px;
      border:0;
      background: var(--accent);
      color:white;
      font-weight: 900;
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(75,124,255,.22);
    }
    .hint{
      margin-top: 8px;
      color: var(--sub);
      font-size: 12px;
    }

    .logHeader{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .danger{
      padding: 10px 14px;
      border-radius: 12px;
      border:0;
      background: var(--danger);
      color:white;
      font-weight: 900;
      cursor:pointer;
    }
    .logList{
      margin-top: 10px;
      border-top: 1px dashed var(--line);
      padding-top: 10px;
    }
    .logItem{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 12px 10px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: white;
      margin-bottom: 10px;
    }
    .logLeft{
      display:flex;
      flex-direction:column;
      gap:3px;
      min-width: 0;
    }
    .logText{
      font-weight: 900;
      font-size: 15px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .logMeta{
      font-size: 12px;
      color: var(--sub);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .delBtn{
      border:0;
      background: #eef1f7;
      color:#415062;
      font-weight: 900;
      padding: 10px 12px;
      border-radius: 12px;
      cursor:pointer;
      white-space: nowrap;
    }

    .empty{
      color: var(--sub);
      font-size: 13px;
      padding: 10px 2px;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title"><span class="dot"></span>„Åó„Åü„Åì„Å®„É≠„Ç∞</div>
      <div class="today" id="todayDate"></div>
    </header>

    <div class="tabs" id="tabs"></div>

    <div class="card">
      <div class="sectionTitle" id="catLabel"></div>

      <div class="presetGrid" id="presetGrid"></div>

      <div class="addRow">
        <input id="customInput" type="text" placeholder="‰æãÔºö„ÅîÈ£Ø„ÄÅËñ¨„ÄÅÊ¥óÈ°î „Å™„Å©" />
        <button class="addBtn" id="customAddBtn">ËøΩÂä†</button>
      </div>
      <div class="hint">‚Äª ËøΩÂä†„Åó„ÅüÊñáÂ≠ó„ÅØ„Äå‰ªäÈÅ∏„Çì„Åß„Çã„Ç´„ÉÜ„Ç¥„É™„Äç„Å´Ë®òÈå≤„Åï„Çå„Åæ„Åô</div>
    </div>

    <div class="card">
      <div class="logHeader">
        <div class="sectionTitle">‰ªäÊó•„ÅÆ„É≠„Ç∞</div>
        <button class="danger" id="clearAllBtn">ÂÖ®ÂâäÈô§</button>
      </div>

      <div class="logList" id="logList"></div>
      <div class="empty" id="emptyText" style="display:none;">„Åæ„Å†„É≠„Ç∞„Åå„Å™„ÅÑ„Çà üëÄ</div>
    </div>
  </div>

  <script>
    // ========= Ë®≠ÂÆö =========
    const CATEGORIES = ["ÂÆ∂‰∫ã", "Ë≤∑„ÅÑÁâ©", "ÈÄ£Áµ°", "Â§ñÂá∫", "Áî®‰∫ã", "„Åù„ÅÆ‰ªñ"];

    // „Éó„É™„Çª„ÉÉ„ÉàÔºàÊúÄÂàù„Åã„ÇâÂá∫„Åô„Éú„Çø„É≥Ôºâ
    const PRESETS = {
      "ÂÆ∂‰∫ã": ["Ê¥óÊøØ", "È¢®ÂëÇ", "ÊñôÁêÜ", "Áâá‰ªò„Åë", "„Ç¥„ÉüÂá∫„Åó"],
      "Ë≤∑„ÅÑÁâ©": ["„Çπ„Éº„Éë„Éº", "„Éâ„É©„ÉÉ„Ç∞„Çπ„Éà„Ç¢", "„Ç≥„É≥„Éì„Éã", "„Éç„ÉÉ„ÉàÊ≥®Êñá"],
      "ÈÄ£Áµ°": ["ÈõªË©±", "LINEËøî‰ø°", "„É°„Éº„É´", "‰∫àÁ¥Ñ", "ÈÄ£Áµ°„Åó„Åü"],
      "Â§ñÂá∫": ["Êï£Ê≠©", "ÈÄöÈô¢", "Êñ≠ÈÖí‰ºö", "Â§ñÂá∫„Åó„Åü", "Áî®‰∫ã„ÅßÂ§ñÂá∫"],
      "Áî®‰∫ã": ["ÊâãÁ∂ö„Åç", "ÊîØÊâï„ÅÑ", "ÂΩπÊâÄ", "ÊèêÂá∫", "Áâá‰ªò„ÅëÔºàÁî®‰∫ãÔºâ"],
      // „Åç„Çä„Å°„ÇÉ„Çì„ÅÆÂ∏åÊúõÔºö„Åù„ÅÆ‰ªñ„Å´„Äå„ÅîÈ£Ø„ÉªËñ¨„ÉªÊ¥óÈ°î„Äç„ÇíÂÖ•„Çå„Çã
      "„Åù„ÅÆ‰ªñ": ["„ÅîÈ£Ø", "Ëñ¨", "Ê¥óÈ°î"]
    };

    const STORAGE_KEY = "shitaKotoLog_v2";

    // ========= Áä∂ÊÖã =========
    let state = {
      currentCategory: "ÂÆ∂‰∫ã",
      logs: [] // { id, text, category, createdAtISO }
    };

    // ========= „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£ =========
    const pad2 = (n) => String(n).padStart(2, "0");

    function formatDateJP(d){
      // 2026/02/04(Ê∞¥) „Åø„Åü„ÅÑ„Å™Ë°®Á§∫
      const y = d.getFullYear();
      const m = pad2(d.getMonth()+1);
      const day = pad2(d.getDate());
      const w = ["Êó•","Êúà","ÁÅ´","Ê∞¥","Êú®","Èáë","Âúü"][d.getDay()];
      return `${y}/${m}/${day}(${w})`;
    }

    function formatTime(d){
      return `${pad2(d.getHours())}:${pad2(d.getMinutes())}`;
    }

    function save(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }
    function load(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return;
      try{
        const parsed = JSON.parse(raw);
        // ÊúÄ‰ΩéÈôê„ÅÆÂΩ¢„Å†„ÅëÂêà„Çè„Åõ„Çã
        if(parsed && typeof parsed === "object"){
          if(Array.isArray(parsed.logs)) state.logs = parsed.logs;
          if(typeof parsed.currentCategory === "string") state.currentCategory = parsed.currentCategory;
        }
      }catch(e){}
    }

    // ========= ËøΩÂä†/ÂâäÈô§ =========
    function addLog(text, category){
      const now = new Date();
      const item = {
        id: cryptoRandomId(),
        text: text,
        category: category,
        createdAtISO: now.toISOString()
      };
      state.logs.unshift(item);
      save();
      renderLog();
    }

    function deleteLog(id){
      state.logs = state.logs.filter(x => x.id !== id);
      save();
      renderLog();
    }

    function clearAll(){
      if(!confirm("ÂÖ®ÈÉ®Ê∂à„ÅôÔºüÔºàÂÖÉ„Å´Êàª„Åõ„Å™„ÅÑÔºâ")) return;
      state.logs = [];
      save();
      renderLog();
    }

    function cryptoRandomId(){
      // iPhone Safari„Åß„ÇÇÂãï„ÅèÂÆâÂÖ®ÂØÑ„Çä
      return "id_" + Math.random().toString(16).slice(2) + "_" + Date.now().toString(16);
    }

    // ========= UIÊèèÁîª =========
    function renderTabs(){
      const el = document.getElementById("tabs");
      el.innerHTML = "";
      CATEGORIES.forEach(cat => {
        const b = document.createElement("button");
        b.className = "tab" + (cat === state.currentCategory ? " active" : "");
        b.textContent = cat;
        b.addEventListener("click", () => {
          state.currentCategory = cat;
          save();
          renderTabs();
          renderPresets();
        });
        el.appendChild(b);
      });
    }

    function renderPresets(){
      document.getElementById("catLabel").textContent = state.currentCategory;

      const grid = document.getElementById("presetGrid");
      grid.innerHTML = "";

      const list = PRESETS[state.currentCategory] || [];
      list.forEach(txt => {
        const btn = document.createElement("button");
        btn.className = "presetBtn";
        btn.textContent = txt;
        btn.addEventListener("click", () => addLog(txt, state.currentCategory));
        grid.appendChild(btn);
      });
    }

    function renderTodayDate(){
      const todayEl = document.getElementById("todayDate");
      if(!todayEl) return;
      const d = new Date();
      todayEl.textContent = `Êó•‰ªòÔºö${formatDateJP(d)}`;
    }

    function renderLog(){
      const listEl = document.getElementById("logList");
      const emptyEl = document.getElementById("emptyText");
      listEl.innerHTML = "";

      if(state.logs.length === 0){
        emptyEl.style.display = "block";
        return;
      }
      emptyEl.style.display = "none";

      state.logs.forEach(item => {
        const d = new Date(item.createdAtISO);
        const dateText = formatDateJP(d);
        const timeText = formatTime(d);

        const row = document.createElement("div");
        row.className = "logItem";

        const left = document.createElement("div");
        left.className = "logLeft";

        const t = document.createElement("div");
        t.className = "logText";
        t.textContent = item.text;

        const meta = document.createElement("div");
        meta.className = "logMeta";
        // ‚òÖ„Åì„Åì„Åß„Äå„É≠„Ç∞ÂÅ¥„Å´„ÇÇÊó•‰ªò„Äç„ÇíË°®Á§∫„Åô„Çã
        meta.textContent = `${item.category}„Éª${timeText}„Éª${dateText}`;

        left.appendChild(t);
        left.appendChild(meta);

        const del = document.createElement("button");
        del.className = "delBtn";
        del.textContent = "ÂâäÈô§";
        del.addEventListener("click", () => deleteLog(item.id));

        row.appendChild(left);
        row.appendChild(del);

        listEl.appendChild(row);
      });
    }

    // ========= „Ç§„Éô„É≥„Éà =========
    function wire(){
      const customInput = document.getElementById("customInput");
      const customAddBtn = document.getElementById("customAddBtn");
      const clearAllBtn = document.getElementById("clearAllBtn");

      customAddBtn.addEventListener("click", () => {
        const text = (customInput.value || "").trim();
        if(!text) return;
        addLog(text, state.currentCategory);
        customInput.value = "";
        customInput.focus();
      });

      customInput.addEventListener("keydown", (e) => {
        if(e.key === "Enter"){
          const text = (customInput.value || "").trim();
          if(!text) return;
          addLog(text, state.currentCategory);
          customInput.value = "";
        }
      });

      clearAllBtn.addEventListener("click", clearAll);
    }

    // ========= Ëµ∑Âãï =========
    load();
    renderTodayDate();
    renderTabs();
    renderPresets();
    renderLog();
    wire();
  </script>
</body>
</html>

