<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>„Åó„Åü„Åì„Å®„É≠„Ç∞</title>
  <style>
    :root{
      --bg:#f7f9ff;
      --card:#ffffffcc;
      --ink:#1b1f2a;
      --sub:#5f6b7a;
      --accent:#4b7cff;
      --pill:#e9f0ff;
      --line:#e7ecf6;
      --shadow: 0 10px 30px rgba(20, 40, 90, .08);
      --radius: 22px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
      background: radial-gradient(1200px 700px at 20% 0%, #eef2ff 0%, var(--bg) 55%, #f9fbff 100%);
      color:var(--ink);
    }
    .wrap{
      max-width: 760px;
      margin: 0 auto;
      padding: 28px 16px 56px;
    }
    .title{
      display:flex; align-items:center; gap:10px;
      font-size: 30px; font-weight: 800; letter-spacing:.02em;
      margin: 8px 0 8px;
    }
    .dot{
      width:18px; height:18px; border-radius:50%;
      background: #ffd84a;
      box-shadow: 0 6px 18px rgba(255, 216, 74, .35);
    }
    .today{
      color: var(--accent);
      font-weight: 700;
      margin: 0 0 14px;
      font-size: 18px;
    }

    .pills{
      display:flex; flex-wrap:wrap; gap:10px;
      margin: 10px 0 18px;
    }
    .pill{
      border: 0;
      padding: 10px 14px;
      border-radius: 999px;
      background: var(--pill);
      color: var(--accent);
      font-weight: 800;
      cursor: pointer;
      transition: transform .05s ease, filter .15s ease;
    }
    .pill:active{ transform: scale(.98); }
    .pill.active{
      background: var(--accent);
      color: white;
      filter: drop-shadow(0 10px 20px rgba(75,124,255,.25));
    }

    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      backdrop-filter: blur(8px);
      margin: 14px 0;
    }
    .card h3{
      margin: 0 0 12px;
      font-size: 15px;
      color: var(--sub);
      font-weight: 800;
    }
    .bigBtns{
      display:flex; flex-direction:column; gap:12px;
    }
    .bigBtn{
      border: 1px solid var(--line);
      background: white;
      border-radius: 16px;
      padding: 14px 16px;
      font-size: 18px;
      font-weight: 800;
      color: #3a4656;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(20,40,90,.06);
      transition: transform .05s ease, box-shadow .15s ease;
    }
    .bigBtn:active{ transform: scale(.99); }
    .bigBtn:hover{ box-shadow: 0 10px 24px rgba(20,40,90,.09); }

    .addRow{
      display:flex; gap:10px; align-items:center;
      margin-top: 8px;
    }
    input[type="text"]{
      flex:1;
      border: 1px solid var(--line);
      background: #fff;
      border-radius: 16px;
      padding: 12px 14px;
      font-size: 16px;
      outline: none;
    }
    .addBtn{
      border:0;
      border-radius: 16px;
      padding: 12px 16px;
      background: var(--accent);
      color: white;
      font-weight: 900;
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(75,124,255,.25);
    }
    .addBtn:active{ transform: scale(.99); }

    .logItem{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
      padding: 12px 10px;
      border-top: 1px solid var(--line);
    }
    .logLeft{
      display:flex; flex-direction:column; gap:2px;
      min-width:0;
    }
    .logMain{
      font-weight: 900;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .logMeta{
      color: var(--sub);
      font-size: 12px;
      font-weight: 700;
    }
    .delBtn{
      border:1px solid var(--line);
      background:white;
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      color:#6b7280;
      font-weight:900;
    }
    .empty{
      color: var(--sub);
      font-weight: 800;
      text-align:center;
      padding: 10px 0 2px;
    }
    .footerHint{
      margin-top: 10px;
      color: #8a93a3;
      font-size: 12px;
      font-weight: 700;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title"><span class="dot"></span>„Åó„Åü„Åì„Å®„É≠„Ç∞</div>
    <div class="today">‰ªäÊó•Ôºö<span id="todayCount">0</span>‰ª∂</div>

    <div class="pills" id="categoryPills"></div>

    <div class="card">
      <h3 id="categoryTitle">„Ç´„ÉÜ„Ç¥„É™</h3>
      <div class="bigBtns" id="presetButtons"></div>

      <div class="addRow">
        <input id="customInput" type="text" placeholder="‰æãÔºö„ÅîÈ£Ø„ÄÅËñ¨„ÄÅÊ¥óÈ°î „Å™„Å©" />
        <button class="addBtn" id="customAddBtn">ËøΩÂä†</button>
      </div>
      <div class="footerHint">‚Äª ËøΩÂä†„Åó„ÅüÊñáÂ≠ó„ÅØ„Äå‰ªäÈÅ∏„Çì„Åß„Çã„Ç´„ÉÜ„Ç¥„É™„Äç„Å´Ë®òÈå≤„Åï„Çå„Åæ„Åô</div>
    </div>

    <div class="card">
      <h3>‰ªäÊó•„ÅÆ„É≠„Ç∞</h3>
      <div id="logList"></div>
    </div>
  </div>

  <script>
    // ===== Ë®≠ÂÆöÔºà„Ç´„ÉÜ„Ç¥„É™„Å®È†ÖÁõÆÔºâ=====
    const categories = {
      "ÂÆ∂‰∫ã": ["Ê¥óÊøØ", "È¢®ÂëÇ", "ÊñôÁêÜ", "Áâá‰ªò„Åë", "„Ç¥„ÉüÂá∫„Åó"],
      "Ë≤∑„ÅÑÁâ©": ["„Çπ„Éº„Éë„Éº", "„Éâ„É©„ÉÉ„Ç∞„Çπ„Éà„Ç¢", "„Ç≥„É≥„Éì„Éã", "„Éç„ÉÉ„ÉàÊ≥®Êñá"],
      "ÈÄ£Áµ°": ["ÈõªË©±", "LINEËøî„Åô", "‰∫àÁ¥Ñ", "Âïè„ÅÑÂêà„Çè„Åõ"],
      "Â§ñÂá∫": ["Êï£Ê≠©", "ÈÄöÈô¢", "Áî®‰∫ã„ÅßÂ§ñ", "ÂèãÈÅî"],
      "Áî®‰∫ã": ["ÊâãÁ∂ö„Åç", "ÊèêÂá∫", "ÊåØËæº", "‰∫àÁ¥ÑÂ§âÊõ¥"],
      // ‚òÖËøΩÂä†Ôºö„Åù„ÅÆ‰ªñ„Ç´„ÉÜ„Ç¥„É™Ôºà„ÅîÈ£Ø„ÉªËñ¨„ÉªÊ¥óÈ°îÔºâ
      "„Åù„ÅÆ‰ªñ": ["„ÅîÈ£Ø", "Ëñ¨", "Ê¥óÈ°î"]
    };

    // ===== ‰øùÂ≠òÔºàlocalStorageÔºâ=====
    const STORAGE_KEY = "shitakoto_log_v1";

    function getTodayKey(){
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,"0");
      const day = String(d.getDate()).padStart(2,"0");
      return `${y}-${m}-${day}`;
    }

    function loadAll(){
      try{
        return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
      }catch(e){
        return {};
      }
    }
    function saveAll(all){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(all));
    }

    function loadToday(){
      const all = loadAll();
      const key = getTodayKey();
      return all[key] || [];
    }
    function saveToday(items){
      const all = loadAll();
      const key = getTodayKey();
      all[key] = items;
      saveAll(all);
    }

    // ===== UI =====
    const categoryPills = document.getElementById("categoryPills");
    const presetButtons = document.getElementById("presetButtons");
    const categoryTitle = document.getElementById("categoryTitle");
    const customInput = document.getElementById("customInput");
    const customAddBtn = document.getElementById("customAddBtn");
    const logList = document.getElementById("logList");
    const todayCount = document.getElementById("todayCount");

    let currentCategory = Object.keys(categories)[0];

    function renderCategories(){
      categoryPills.innerHTML = "";
      Object.keys(categories).forEach(cat=>{
        const btn = document.createElement("button");
        btn.className = "pill" + (cat === currentCategory ? " active" : "");
        btn.textContent = cat;
        btn.addEventListener("click", ()=>{
          currentCategory = cat;
          renderCategories();
          renderPresets();
        });
        categoryPills.appendChild(btn);
      });
    }

    function addLog(text, category){
      const items = loadToday();
      items.unshift({
        id: crypto.randomUUID ? crypto.randomUUID() : String(Date.now()) + Math.random(),
        text,
        category,
        at: new Date().toISOString()
      });
      saveToday(items);
      renderLog();
    }

    function renderPresets(){
      categoryTitle.textContent = currentCategory;
      presetButtons.innerHTML = "";
      const list = categories[currentCategory] || [];
      list.forEach(label=>{
        const b = document.createElement("button");
        b.className = "bigBtn";
        b.textContent = label;
        b.addEventListener("click", ()=> addLog(label, currentCategory));
        presetButtons.appendChild(b);
      });
    }

    function renderLog(){
      const items = loadToday();
      todayCount.textContent = String(items.length);

      logList.innerHTML = "";
      if(items.length === 0){
        const empty = document.createElement("div");
        empty.className = "empty";
        empty.textContent = "„Åæ„Å†0‰ª∂„ÄÇÊäº„Åó„Åü„ÇâË®òÈå≤„Åï„Çå„Çã„Çàüëç";
        logList.appendChild(empty);
        return;
      }

      items.forEach(item=>{
        const row = document.createElement("div");
        row.className = "logItem";

        const left = document.createElement("div");
        left.className = "logLeft";

        const main = document.createElement("div");
        main.className = "logMain";
        main.textContent = item.text;

        const meta = document.createElement("div");
        meta.className = "logMeta";
        const t = new Date(item.at);
        const hh = String(t.getHours()).padStart(2,"0");
        const mm = String(t.getMinutes()).padStart(2,"0");
        meta.textContent = `${item.category}„Éª${hh}:${mm}`;

        left.appendChild(main);
        left.appendChild(meta);

        const del = document.createElement("button");
        del.className = "delBtn";
        del.textContent = "ÂâäÈô§";
        del.addEventListener("click", ()=>{
          const itemsNow = loadToday().filter(x=> x.id !== item.id);
          saveToday(itemsNow);
          renderLog();
        });

        row.appendChild(left);
        row.appendChild(del);
        logList.appendChild(row);
      });
    }

    // ÂÖ•Âäõ„ÅßËøΩÂä†Ôºà„Äå„ÄÅ„Äç„Äå,„Äç„ÅßË§áÊï∞ÂÖ•ÂäõOKÔºâ
    function addFromInput(){
      const raw = customInput.value.trim();
      if(!raw) return;

      const parts = raw.split(/[„ÄÅ,]/).map(s=>s.trim()).filter(Boolean);
      parts.forEach(p=> addLog(p, currentCategory));
      customInput.value = "";
      customInput.focus();
    }

    customAddBtn.addEventListener("click", addFromInput);
    customInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") addFromInput();
    });

    // ÂàùÊúüË°®Á§∫
    renderCategories();
    renderPresets();
    renderLog();
  </script>
</body>
</html>
