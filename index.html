<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>„Åó„Åü„Åì„Å®„É≠„Ç∞</title>

  <style>
    :root{
      --bg:#f7f9ff;
      --card:#ffffffcc;
      --ink:#1b1f2a;
      --sub:#5f6b7a;
      --accent:#3b5cff;
      --pill:#e9f0ff;
      --line:#e7ecf6;
    }

    body{
      margin:0;
      background:var(--bg);
      font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif;
      color:var(--ink);
      padding:18px;
    }

    .wrap{ max-width: 700px; margin:0 auto; }

    .title{
      display:flex;
      align-items:flex-end;
      gap:12px;
      margin:8px 0 10px;
    }
    .title h1{
      font-size:22px;
      margin:0;
      font-weight:800;
      letter-spacing:.02em;
    }
    .today{
      margin:0;
      font-size:14px;
      color:var(--sub);
      font-weight:600;
    }

    .cats{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin:12px 0 14px;
    }
    .catBtn{
      border:none;
      padding:10px 16px;
      border-radius:999px;
      background:var(--pill);
      color:#2f5cff;
      font-weight:700;
      font-size:14px;
    }
    .catBtn.active{
      background:var(--accent);
      color:white;
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      padding:16px;
      box-shadow: 0 8px 18px rgba(20,30,60,.06);
      margin-bottom:16px;
    }

    .presets{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:10px;
    }
    .presetBtn{
      border:none;
      width:100%;
      padding:14px 14px;
      border-radius:16px;
      background:white;
      border:1px solid var(--line);
      font-size:16px;
      font-weight:700;
      color:#2a2f3a;
    }

    .inputRow{
      display:flex;
      gap:10px;
      align-items:center;
      margin-top:12px;
    }
    #customInput{
      flex:1;
      border:1px solid var(--line);
      border-radius:16px;
      padding:14px 14px;
      font-size:16px;
      outline:none;
      background:white;
    }
    .addBtn{
      border:none;
      background:var(--accent);
      color:white;
      font-weight:800;
      border-radius:16px;
      padding:14px 16px;
      min-width:80px;
    }
    .hint{
      font-size:12px;
      color:var(--sub);
      margin-top:8px;
    }

    .logHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin:0 0 10px;
    }
    .logHead h2{
      margin:0;
      font-size:16px;
    }
    .danger{
      border:none;
      background:#ff4d4d;
      color:white;
      font-weight:800;
      border-radius:12px;
      padding:10px 12px;
      font-size:13px;
    }

    .logList{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .logItem{
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:white;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px 12px;
      gap:12px;
    }
    .logText{
      font-weight:800;
      line-height:1.2;
    }
    .logMeta{
      font-size:12px;
      color:var(--sub);
      margin-top:4px;
      font-weight:600;
    }
    .delBtn{
      border:none;
      background:#f3f5fb;
      color:#5c6676;
      font-weight:800;
      border-radius:12px;
      padding:10px 12px;
      white-space:nowrap;
    }

    .empty{
      color:var(--sub);
      font-size:13px;
      margin:6px 0 0;
    }
  </style>
</head>

<body>
<div class="wrap">

  <div class="title">
    <h1>üü° „Åó„Åü„Åì„Å®„É≠„Ç∞</h1>
    <!-- ‚òÖ„Åì„Åì„Å´Êó•‰ªò„ÅåÂá∫„Çã -->
    <p class="today" id="todayDate">Êó•‰ªòÔºö--</p>
  </div>

  <div class="cats" id="categories"></div>

  <div class="card">
    <div class="presets" id="presets"></div>

    <div class="inputRow">
      <input id="customInput" placeholder="‰æãÔºö„ÅîÈ£Ø„ÄÅËñ¨„ÄÅÊ¥óÈ°î „Å™„Å©" />
      <button class="addBtn" id="customAddBtn">ËøΩÂä†</button>
    </div>

    <div class="hint">‚Äª ËøΩÂä†„Åó„ÅüÊñáÂ≠ó„ÅØ„Äå‰ªäÈÅ∏„Çì„Åß„Çã„Ç´„ÉÜ„Ç¥„É™„Äç„Å´Ë®òÈå≤„Åï„Çå„Åæ„Åô</div>
  </div>

  <div class="card">
    <div class="logHead">
      <h2>‰ªäÊó•„ÅÆ„É≠„Ç∞</h2>
      <!-- ‚òÖ„Åì„Åì„Åå„ÄåÂÖ®ÂâäÈô§„Äç -->
      <button class="danger" id="deleteAllBtn">ÂÖ®ÂâäÈô§</button>
    </div>

    <div class="logList" id="logList"></div>
    <div class="empty" id="emptyText" style="display:none;">„Åæ„Å†„É≠„Ç∞„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>
  </div>

</div>

<script>
  /* ========= Ë®≠ÂÆö ========= */
  const categories = ["ÂÆ∂‰∫ã", "Ë≤∑„ÅÑÁâ©", "ÈÄ£Áµ°", "Â§ñÂá∫", "Áî®‰∫ã", "„Åù„ÅÆ‰ªñ"];

  const presets = {
    ÂÆ∂‰∫ã: ["Ê¥óÊøØ", "È¢®ÂëÇ", "ÊñôÁêÜ", "Áâá‰ªò„Åë", "„Ç¥„ÉüÂá∫„Åó"],
    Ë≤∑„ÅÑÁâ©: ["„Çπ„Éº„Éë„Éº", "„Éâ„É©„ÉÉ„Ç∞„Çπ„Éà„Ç¢", "„Ç≥„É≥„Éì„Éã", "„Éç„ÉÉ„ÉàÊ≥®Êñá"],
    ÈÄ£Áµ°: ["ÈõªË©±", "LINE", "„É°„Éº„É´"],
    Â§ñÂá∫: ["ÈÄöÈô¢", "Êï£Ê≠©", "ÁßªÂãï"],
    Áî®‰∫ã: ["ÂΩπÊâÄ", "ÊîØÊâï„ÅÑ", "ÈÉµ‰æø", "ÊâãÁ∂ö„Åç"],
    „Åù„ÅÆ‰ªñ: ["„ÅîÈ£Ø", "Ëñ¨", "Ê¥óÈ°î"]
  };

  const STORAGE_KEY = "shitakoto_logs_v1";

  let currentCategory = "ÂÆ∂‰∫ã";
  let logs = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

  /* ========= Êó•‰ªòË°®Á§∫ ========= */
  const todayEl = document.getElementById("todayDate");
  const d = new Date();
  const dateText = d.toLocaleDateString("ja-JP", {
    year: "numeric",
    month: "2-digit",
    day: "2-digit",
    weekday: "short"
  });
  todayEl.textContent = `Êó•‰ªòÔºö${dateText}`;

  /* ========= ÊèèÁîª ========= */
  function renderCategories(){
    const el = document.getElementById("categories");
    el.innerHTML = "";
    categories.forEach(c=>{
      const b = document.createElement("button");
      b.className = "catBtn" + (c === currentCategory ? " active" : "");
      b.textContent = c;
      b.onclick = () => {
        currentCategory = c;
        renderCategories();
        renderPresets();
      };
      el.appendChild(b);
    });
  }

  function renderPresets(){
    const el = document.getElementById("presets");
    el.innerHTML = "";
    (presets[currentCategory] || []).forEach(p=>{
      const b = document.createElement("button");
      b.className = "presetBtn";
      b.textContent = p;
      b.onclick = () => addLog(p);
      el.appendChild(b);
    });
  }

  function renderLog(){
    const el = document.getElementById("logList");
    const emptyEl = document.getElementById("emptyText");
    el.innerHTML = "";

    if (logs.length === 0){
      emptyEl.style.display = "block";
      return;
    }
    emptyEl.style.display = "none";

    logs.forEach((l, i)=>{
      const row = document.createElement("div");
      row.className = "logItem";

      const left = document.createElement("div");
      left.innerHTML = `
        <div class="logText">${escapeHtml(l.text)}</div>
        <div class="logMeta">${escapeHtml(l.category)}„Éª${escapeHtml(l.time)}</div>
      `;

      const del = document.createElement("button");
      del.className = "delBtn";
      del.textContent = "ÂâäÈô§";
      del.onclick = () => removeLog(i);

      row.appendChild(left);
      row.appendChild(del);
      el.appendChild(row);
    });
  }

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  /* ========= ËøΩÂä†/ÂâäÈô§ ========= */
  function save(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
  }

  function addLog(text){
    const t = new Date().toLocaleTimeString("ja-JP", { hour:"2-digit", minute:"2-digit" });
    logs.unshift({ text, category: currentCategory, time: t });
    save();
    renderLog();
  }

  function removeLog(i){
    logs.splice(i, 1);
    save();
    renderLog();
  }

  function deleteAll(){
    if (!confirm("‰ªäÊó•„ÅÆ„É≠„Ç∞„ÇíÂÖ®ÈÉ®Ê∂à„ÅôÔºü")) return;
    logs = [];
    save();
    renderLog();
  }

  /* ========= ÂÖ•Âäõ ========= */
  const customInput = document.getElementById("customInput");
  document.getElementById("customAddBtn").onclick = () => {
    const text = customInput.value.trim();
    if (!text) return;
    addLog(text);
    customInput.value = "";
  };

  customInput.addEventListener("keydown", (e)=>{
    if (e.key === "Enter") document.getElementById("customAddBtn").click();
  });

  document.getElementById("deleteAllBtn").onclick = deleteAll;

  /* ========= ÂàùÊúü ========= */
  renderCategories();
  renderPresets();
  renderLog();
</script>

</body>
</html>
