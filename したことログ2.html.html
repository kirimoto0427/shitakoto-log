<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ã—ãŸã“ã¨ãƒ­ã‚°</title>

<style>
body{
font-family:system-ui;
background:#FFFFFF;
padding:20px;
color:#222;
}

/* ã‚¿ã‚¤ãƒˆãƒ« */
.title{
font-size:22px;
font-weight:700;
margin-bottom:6px;
}

.today{
color:#7A78FF;
font-weight:600;
margin-bottom:20px;
}

/* ã‚«ãƒ†ã‚´ãƒª */
.catWrap{
display:flex;
flex-wrap:wrap;
gap:14px;
margin-bottom:32px;
}

.catBtn{
background:#F5F7FF;
border:none;
padding:12px 18px;
border-radius:20px;
font-size:15px;
font-weight:500;
box-shadow:0 2px 8px rgba(0,0,0,0.04);
}

.catActive{
background:#ECEBFF;
}

/* ã‚«ãƒ¼ãƒ‰ */
.card{
background:#F5F7FF;
border-radius:20px;
padding:18px;
margin-bottom:32px;
box-shadow:0 2px 8px rgba(0,0,0,0.04);
}

/* é …ç›®ãƒœã‚¿ãƒ³ */
.itemBtn{
display:block;
width:100%;
border:none;
background:#FFFFFF;
padding:14px;
margin-bottom:12px;
border-radius:16px;
font-size:15px;
}

/* å…¥åŠ› */
input{
width:70%;
padding:12px;
border-radius:14px;
border:1px solid #eee;
margin-right:8px;
}

/* æ“ä½œ */
.actionBtn{
background:#FFEFF6;
border:none;
padding:12px 16px;
border-radius:16px;
margin-right:10px;
}

/* ãƒ­ã‚° */
.logItem{
background:#FFFFFF;
padding:12px;
border-radius:14px;
margin-bottom:10px;
font-size:14px;
color:#444;
}

/* æŠ¼ã—ãŸãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ */
button:active{
transform:scale(0.98);
background:#DCD9FF;
transition:0.08s;
}
</style>
</head>

<body>

<div class="title">ğŸŸ¡ ã—ãŸã“ã¨ãƒ­ã‚°</div>
<div class="today" id="todayCount">ä»Šæ—¥ï¼š0ä»¶</div>

<!-- ã‚«ãƒ†ã‚´ãƒª -->
<div class="catWrap" id="cats"></div>

<!-- é …ç›®ã‚«ãƒ¼ãƒ‰ -->
<div class="card">
<div id="items"></div>
</div>

<!-- è‡ªç”±å…¥åŠ› -->
<div class="card">
<input id="freeText" placeholder="ãã®ä»–ã—ãŸã“ã¨">
<button class="itemBtn" onclick="addFree()">è¿½åŠ </button>
</div>

<!-- æ“ä½œ -->
<div class="card">
<button class="actionBtn" onclick="undo()">â†© å–ã‚Šæ¶ˆã—</button>
<button class="actionBtn" onclick="clearAll()">å…¨æ¶ˆå»</button>
</div>

<!-- ãƒ­ã‚° -->
<div class="card">
<div id="log"></div>
</div>

<script>
const KEY="doneLogs";

const data={
"å®¶äº‹":["æ´—æ¿¯","é¢¨å‘‚","æ–™ç†","ç‰‡ä»˜ã‘","ã‚´ãƒŸå‡ºã—"],
"è²·ã„ç‰©":["ã‚¹ãƒ¼ãƒ‘ãƒ¼","ãƒ‰ãƒ©ãƒƒã‚°ã‚¹ãƒˆã‚¢","ã‚³ãƒ³ãƒ“ãƒ‹","ãƒãƒƒãƒˆæ³¨æ–‡"],
"é€£çµ¡":["LINE","é›»è©±","äºˆç´„","è¿”ä¿¡"],
"å¤–å‡º":["æ•£æ­©","ç§»å‹•","é€šé™¢","å½¹æ‰€","å¤–é£Ÿ"],
"ç”¨äº‹":["æ›¸é¡","æ”¯æ‰•ã„","æ‰‹ç¶šã","æå‡º"]
};

let currentCat="å®¶äº‹";
let lastAdded=null;

function nowText(){
const n=new Date();
return `${n.getFullYear()}/${n.getMonth()+1}/${n.getDate()} `
+`${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`;
}

function isToday(str){
const d=new Date();
const today=`${d.getFullYear()}/${d.getMonth()+1}/${d.getDate()}`;
return str.startsWith(today);
}

function updateTodayCount(){
let logs=JSON.parse(localStorage.getItem(KEY)||"[]");
let count=logs.filter(l=>isToday(l)).length;
document.getElementById("todayCount").innerText=`ä»Šæ—¥ï¼š${count}ä»¶`;
}

function renderCats(){
let html="";
Object.keys(data).forEach(c=>{
let active=c===currentCat ? "catActive" : "";
html+=`<button class="catBtn ${active}" onclick="setCat('${c}')">${c}</button>`;
});
document.getElementById("cats").innerHTML=html;
}

function renderItems(){
let list=data[currentCat];
let html="";
list.forEach(i=>{
html+=`<button class="itemBtn" onclick="addLog('${i}')">${i}</button>`;
});
document.getElementById("items").innerHTML=html;
}

function setCat(cat){
currentCat=cat;
renderCats();
renderItems();
}

function addLog(item){
let text=`${nowText()} â†’ ${currentCat}ï¼š${item}`;
let logs=JSON.parse(localStorage.getItem(KEY)||"[]");
logs.unshift(text);
localStorage.setItem(KEY,JSON.stringify(logs));
lastAdded=text;
renderLog();
updateTodayCount();
}

function addFree(){
let t=document.getElementById("freeText").value.trim();
if(!t)return;
addLog(t);
document.getElementById("freeText").value="";
}

function undo(){
if(!lastAdded)return;
let logs=JSON.parse(localStorage.getItem(KEY)||"[]");
logs=logs.filter(x=>x!==lastAdded);
localStorage.setItem(KEY,JSON.stringify(logs));
lastAdded=null;
renderLog();
updateTodayCount();
}

function clearAll(){
localStorage.removeItem(KEY);
renderLog();
updateTodayCount();
}

function renderLog(){
let logs=JSON.parse(localStorage.getItem(KEY)||"[]");
let html="";
logs.forEach(l=>{
html+=`<div class="logItem">${l}</div>`;
});
document.getElementById("log").innerHTML=html;
}

renderCats();
renderItems();
renderLog();
updateTodayCount();
</script>

</body>
</html>